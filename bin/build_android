#!/bin/sh
cordova prepare
# use crosswalk for lower-version compatibility
# change config.xml to level=16
xsltproc --stringparam min 16 --stringparam target 22 --stringparam max 19 -o config.xml bin/minsdk_version_change.xsl config.xml 
cordova plugin add cordova-plugin-crosswalk-webview
cordova build android --release -- --gradleArg=-PcdvMinSdkVersion=16 
cp platforms/android/build/outputs/apk/android-armv7-release.apk builds/android-armv7-release.apk
cp platforms/android/build/outputs/apk/android-x86-release.apk builds/android-x86-release.apk
# --gradleArg=-PcdvBuildMultipleApks=false
# remove crosswalk for higher-version compatibility with smaller footprint
# change config.xml to level=19
xsltproc --stringparam min 19 --stringparam target 22 --stringparam max '' -o config.xml bin/minsdk_version_change.xsl config.xml
cordova plugin remove cordova-plugin-crosswalk-webview
cordova build android --release -- --gradleArg=-PcdvMinSdkVersion=19 --gradleArg=-PcdvBuildMultipleApks=false
cp platforms/android/build/outputs/apk/android-release.apk builds/android-release.apk
